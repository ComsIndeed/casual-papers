---
import type { GetStaticPaths } from "astro";
import { contents } from "../index.astro";
import DocumentLayout from "../../layouts/DocumentLayout.astro";

export const getStaticPaths = (() => {
  return contents.map((content) => ({
    params: {
      name: content.head.replace(/\s+/g, "-").toLowerCase(),
      id: content.id.toString(),
    },
  }));
}) satisfies GetStaticPaths;

const { name, id } = Astro.params;

const content = contents.find(
  (c) =>
    c.head.replace(/\s+/g, "-").toLowerCase() === name && c.id.toString() === id
)!;
---

<DocumentLayout content={content} backHref="/">
  <header class="mb-8">
    {
      content.imageUrl && (
        <img
          src={content.imageUrl}
          alt={content.head}
          class="w-full max-w-3xl h-64 object-cover rounded-lg shadow-md mb-6 mx-auto"
        />
      )
    }
    <h1 class="text-4xl font-extrabold text-gray-900 mb-2">{content.head}</h1>
    <p class="text-gray-600 mb-1">
      <strong>Author:</strong>
      {content.metadata.author}
    </p>
    <p class="text-gray-600 text-sm">
      <strong>Published:</strong>
      {content.metadata.createdAt.toLocaleDateString()}
    </p>
    <div class="flex flex-wrap gap-2 mt-2">
      {
        content.metadata.tags.map((tag) => (
          <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full">
            {tag}
          </span>
        ))
      }
    </div>
  </header>
  <article
    class="prose lg:prose-lg text-gray-700 leading-relaxed max-w-3xl mx-auto"
  >
    <p>{content.body}</p>
  </article>
</DocumentLayout>

<style lang="scss">
  body {
    display: flex;
    flex-direction: column;
    align-items: start;
  }
  header {
    img {
      max-width: 50%;
      height: auto;
      border-radius: 4px;
      margin-bottom: 1rem;
    }
  }
</style>
